# ============================================================================
# Mealie Recipe Sync Environment Configuration
# ============================================================================
#
# Copy this file to .env and customize for your deployment:
#   cp .env.example .env
#
# ============================================================================

# ============================================================================
# MEALIE API CONFIGURATION
# ============================================================================

# Mealie base URL (use container name if on same network)
MEALIE_BASE_URL=http://mealie:9000

# Mealie API Token (REQUIRED)
# Generate in Mealie: Settings → API Tokens → Create Token
# Give it a descriptive name like "Recipe Sync Service"
MEALIE_API_TOKEN=

# ============================================================================
# SYNC CONFIGURATION
# ============================================================================

# Sync interval in minutes
# How often to check for and import new recipes
# Default: 1440 (24 hours)
# Recommended:
#   - 1440 (24 hours) for daily batch imports
#   - 360-720 (6-12 hours) for more frequent updates
#   - 10080 (weekly) for occasional syncs
SYNC_INTERVAL_MINUTES=1440

# Maximum new recipes to import per sync run
# Prevents overwhelming Mealie or recipe sources
# Default: 10
# Recommended: 10-20 depending on your Mealie instance size
MAX_NEW_RECIPES_PER_RUN=10

# ============================================================================
# NETWORK & RATE LIMITING
# ============================================================================

# Request timeout in seconds
# How long to wait for responses from recipe sites
# Default: 30
REQUEST_TIMEOUT_SECONDS=30

# Rate limit in seconds per domain
# Minimum time between requests to the same domain
# Default: 2.0 (conservative, polite crawling)
# Lower values = faster but less polite
RATE_LIMIT_SECONDS_PER_DOMAIN=2.0

# User agent string for HTTP requests
# Identifies the sync service when making requests
# Default: Mozilla/5.0 (compatible; MealieRecipeSync/1.0)
USER_AGENT=Mozilla/5.0 (compatible; MealieRecipeSync/1.0; +https://github.com/orionsentinel/Orion-Sentinel-CoreSrv)

# ============================================================================
# OPERATIONAL SETTINGS
# ============================================================================

# Dry run mode (true/false)
# When true, discovers URLs but doesn't import to Mealie
# Useful for testing configuration changes
# Default: false
DRY_RUN=false

# JSON structured logging (true/false)
# When true, outputs logs as JSON (useful for Loki/Promtail)
# When false, outputs human-readable logs
# Default: false
JSON_LOGS=false

# ============================================================================
# NOTES
# ============================================================================
#
# 1. MEALIE_API_TOKEN is required - generate it in Mealie web UI first
# 2. Recipe sources are configured in config/recipe_sources.yaml
# 3. Already-imported recipes are tracked in SQLite database and skipped
# 4. The service runs continuously and syncs on the specified interval
# 5. Check logs with: docker logs orion_mealie_sync
#
# Recipe Source Configuration:
#   - Edit stacks/apps/mealie-sync/config/recipe_sources.yaml
#   - 10 curated sources are pre-configured
#   - Enable/disable sources individually with enabled: true/false
#
# Dry Run Testing:
#   1. Set DRY_RUN=true
#   2. Start the service: docker compose --profile food_sync up -d
#   3. Check logs: docker logs -f orion_mealie_sync
#   4. Review discovered URLs without importing
#   5. Set DRY_RUN=false when ready for real imports
#
# ============================================================================
